local uis = game:GetService("UserInputService")
local rs = game:GetService("ReplicatedStorage")
local lp = game:GetService("Players").LocalPlayer

local ability = rs:WaitForChild("GeneralAbility")
local muck = rs:WaitForChild("Events"):WaitForChild("Muck")

local function hasFrostbiteEquipped()
	local char = lp.Character
	if not char then return false end

	for _, tool in ipairs(char:GetChildren()) do
		if tool:IsA("Tool") and tool.Name == "Frostbite" then
			return true
		end
	end
	return false
end

local function addFireEffect()
	local char = lp.Character
	if not char then return end

	local glove = char:FindFirstChild("Glove") or char:FindFirstChild("RightHand") or char:FindFirstChildWhichIsA("Tool")
	if not glove or not glove:IsA("Tool") or glove.Name ~= "Frostbite" then return end

	local handle = glove:FindFirstChild("Handle") or glove:FindFirstChildWhichIsA("BasePart")
	if not handle then return end

	if not handle:FindFirstChild("BlueFire") then
		local fire = Instance.new("Fire")
		fire.Name = "BlueFire"
		fire.Color = Color3.fromRGB(0, 170, 255)
		fire.SecondaryColor = Color3.fromRGB(0, 85, 255)
		fire.Size = 8
		fire.Heat = 10
		fire.Parent = handle
	end
end

local function renameGlove()
	local stats = lp:FindFirstChild("leaderstats")
	local gloveStat = stats and stats:FindFirstChild("Glove")
	if gloveStat and gloveStat:IsA("StringValue") then
		gloveStat.Value = "Frost God"
	end

	local backpack = lp:FindFirstChild("Backpack")
	if backpack then
		for _, tool in ipairs(backpack:GetChildren()) do
			if tool:IsA("Tool") and tool.Name == "Frostbite" then
				tool.Name = "Frost God"
			end
		end
	end

	local char = lp.Character
	if char then
		for _, tool in ipairs(char:GetChildren()) do
			if tool:IsA("Tool") and tool.Name == "Frostbite" then
				tool.Name = "Frost God"
			end
		end
	end
end

uis.InputBegan:Connect(function(input, gp)
	if gp or not hasFrostbiteEquipped() then return end

	if input.KeyCode == Enum.KeyCode.R then
		ability:FireServer(2)
	elseif input.KeyCode == Enum.KeyCode.T then
		muck:FireServer()
	end
end)

if hasFrostbiteEquipped() then
	addFireEffect()
	renameGlove()
end
